Old codes. Working but not good.